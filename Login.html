<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css"
        integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">
    <link rel="stylesheet" href="style/styleloginandregister.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <title>Login</title>
</head>

<body>
    <div class="topnav">
        <a href="Home.html" style="color: white;"><img width="30px" height="5%" src="img/logo.jpg" class="img">Home</a>
        <a href="#news"></a>
        <a href="#contact"></a>
        <div class="topnav-right">
            <button type="button"  class="btn btn-dark" onclick="location.href='Login.html'">Sign in</a>
                <button type="button"  class="btn btn-dark"  id="create-user">Sign Up</button>
        </div>
    </div>

    <div id="dialog-form" title="Register">
        <p class="validateTips">All form fields are required.</p>
    
      
         
            <form id="Frm1" name="Frm1" class="container card p-3">
 <fieldset>
        
                <input type="text" width="100%" name="fName" id="fName" placeholder="Frist Name" pattern="[A-Z a-z]{3,}"
                    required>
        
                <input type="text"  name="sName" id="sName" placeholder="Second Name" pattern="[A-Z a-z]{3,}"
                    required>
        
                <input type="email" name="mail" id="mail" placeholder="Email Address"
                    pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$" required>
        
                <input type="password"  name="psd" id="psd" placeholder="Password"
                    pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$" required>
              
               
     </fieldset>        
            </form>
     
       
      </div>
    <script>

        function addUser() {

            console.log("add user function");
            console.log($("#user").val());
            $("#showName").text("welcome ")

            dialog.dialog("close");

        }

        dialog = $("#dialog-form").dialog({
            autoOpen: false,
            modal: true,
            height: 400,
            width: 350,

            buttons: {
                Register: function () {
                    console.log("add user function");
                    if ($("#mail").val() == "" || $("#psd").val() == "" || $("#sName").val() == "" || $("#fName").val() == "") {
                        alert("Plz,Entre Full Data")
                    }else{
                        var objNewUser={"id":7,"email":$("#mail").val() ,"first_name":$("#fName").val() ,"last_name":$("#sName").val(),"Pass":$("#psd").val()}
                        
                        localStorage.setItem('objNewUser', JSON.stringify(objNewUser));
                        
                        localStorage.setItem("LoginID",7)
                        location.replace("Home.html")
                        alert("User Added");
                        this.dialog("close");
                  

                    }
               

                },
               
            },

        });

        $("#create-user").button()
            .on("click", function () {
                dialog.dialog("open");
            });

    </script>


    <form id="Frm1" name="Frm1" class="container card p-3">
        <img id="logo" name="logo" src="img/logo.jpg" width="150" height="100" class="img">

        <input type="email" class="input" name="mail" id="maill" placeholder="Email Address"
            pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$" value="" required>

        <input type="password" class="input" name="psd" id="psdd" placeholder="Password"
            pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$" value="" required>

        <div class="div">
            <input type="checkbox" id="chPass" onclick="myFunction()"><label for="chPass">Show Password</label>
        </div>
        <div class="popup containerPopup" id="divOverLay">
            <button type="button" class="btnSbmit cancel " onclick="closeForm()">X</button>
            <h3 class="text">something wrong
                <br>
                Check your mail or passwords
            </h3>
        </div>

        <script>
            function myFunction() {
                var Password = document.getElementById("psdd");
                if (Password.type === "password") {
                    Password.type = "text";
                } else {
                    Password.type = "password";
                }
            }
        </script>
        <button type="button" class="btnSbmit" name="btnSbmit" id="btnSbmit">Login</button>
    </form>
    <script>
        $(document).ready(function () {
            $("#btnSbmit").click(function () {

                $.ajax({
                    url: 'users.json',
                    dataType: 'json',
                    contentType: 'json',
                    type: 'get',
                    data:
                    {
                        email: document.getElementById("maill").value,
                        Pass: document.getElementById("psdd").value
                    },
                    success: function (res) {

                        var len = res.data.length;
                        var flag = 0;

                        for (var index = 0; index < len && flag == 0; index++) {
                            console.log(res.data[index]);
                            if (($("#maill").val() === res.data[index].email) && ($("#psdd").val() === res.data[index].Pass)) {
                                console.log("Founded")
                                localStorage.setItem("LoginID",res.data[index].id);    
                                flag = 1;
                                window.location.href = "Home.html"

                            }
                        }
                        if (flag == 0) {
                            document.getElementById("divOverLay").style.display = "block";
                        }

                    },
                    error: function (xhr) {
                        console.log(xhr)
                        console.log(xhr.status + xhr.statusText)
                    },


                });
            });
        });


        function closeForm() {
            document.getElementById("divOverLay").style.display = "none";
        }

    </script>




    </script>
</body>

</html>